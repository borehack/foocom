<h1>Produkte</h1>

<table>
    <tr>
        <td>Name</td>
        <td><input name="name" value="{name}" /></td>
    </tr>
    <tr>
        <td>EAN</td>
        <td><input name="ean" value="{ean}" /></td>
    </tr>
    <tr>
        <td>Min. an Lager</td>
        <td><input name="min_stock" value="{min_stock}" /></td>
    </tr>
    <tr>
        <td>Labels</td>
        <td><select id="labels"><option>w&auml;hlen</option>{labels}</select> &nbsp; <!-- {SPLIT} --><a href="index.php?products-labels-{id}-delete">x</a> {name}, <!-- {SPLIT} --></td>
    </tr>
    <tr>
        <td>Allergene</td>
        <td><select id="allergens"><option>w&auml;hlen</option>{allergens}</select> &nbsp; <!-- {SPLIT} --><span id="allergens_{id}"><a href="delete_allergen({id});">x</a> {name}, <input type="hidden" name="allergens[]" value="{id}" /></span><!-- {SPLIT} --></td>
    </tr>
    <tr>
        <td>N&auml;hrwerte</td>
        <td><input name="food_value" value="{food_value}" /></td>
    </tr>
    <tr>
        <td>Zutaten</td>
        <td><input name="ingredients" value="{ingredients}" /></td>
    </tr>
    <tr>
        <td>Hersteller</td>
        <td><select name="producer">{producer}</select></td>
    </tr>
    <tr>
        <th colspan="2">Beschreibung</th>
    </tr>
    <tr>
        <td colspan="2"><textarea name="description" cols="50" rows="10">{description}</textarea></td>
    </tr>
    <tr>
        <th colspan="2">Bilder</th>
    </tr>
    <tr>
        <td colspan="2">upload</td>
    </tr>
    <tr>
        <th colspan="2">Preise je Kundengruppe</th>
    </tr>
    <tr>
        <td>{customer_group}</td>
        <td><input name="customer_price" value="{customer_price}" /></td>
    </tr>
    <tr>
        <th colspan="2">Lieferanten</th>
    </tr>
    <tr>
        <td align="center" colspan="2">{supplier}<input type="hidden" name="supplier_id[]" value="{supplier_id}" /></td>
    </tr>
    <tr>
        <td>Artikel Nr.</td>
        <td><input name="product_number[]" value="{product_number}" /></td>
    </tr>
    <tr>
        <td>Einkaufspreis</td>
        <td><input name="purchase_price[]" value="{purchase_price}" /></td>
    </tr>
    <tr>
        <td>Lieferanten</td>
        <td>hinzuf&uuml;gen <select id="suppliers"><option>w&auml;hlen</option>{suppliers}</select></td>
    </tr>
    <tr>
        <td></td>
        <td><input type="submit" value="speichern" />
    </td>
</table>

<script type="text/javascript">

$('#suppliers').change(function() {
	var selected_item = $('#suppliers :selected');
	var supplier_name = selected_item.text();
	var supplier_id = selected_item.val();
	$('<tr><td align="center" colspan="2">' + supplier_name + 
		'<input type="hidden" name="supplier_id[]" value="' + supplier_id + '" /></td></tr>' +
		'<tr><td>Artikel Nr.</td><td><input name="product_number[]" /></td></tr>' +
    	'<tr><td>Einkaufspreis</td><td><input name="purchase_price[]" /></td>' +
    	'</tr>').insertBefore($('#suppliers').parent().parent());
	selected_item.remove();
});

$('#allergens').change(function() {
	var selected_item = $('#allergens :selected');
	var allergen_name = selected_item.text();
	var allergen_id = selected_item.val();
	$('#allergens').parent().append('<span id="allergen_' + allergen_id + '"><a href="javascript:delete_allergen(' + allergen_id + ');">x</a> ' + allergen_name + '<input type="hidden" name="allergens[]" value="' + allergen_id + '" />, </span>');
	selected_item.remove();
});

function delete_allergen(allergen_id) {
	$('#allergen_' + allergen_id).remove();
}

$('#labels').change(function() {
	var selected_item = $('#labels :selected');
	var label_name = selected_item.text();
	var label_id = selected_item.val();
	$('#labels').parent().append('<span id="label_' + label_id + '"><a href="javascript:delete_label(' + label_id + ');">x</a> ' + label_name + '<input type="hidden" name="labels[]" value="' + label_id + '" />, </span>');
	selected_item.remove();
});

function delete_label(label_id) {
	$('#label_' + label_id).remove();
}

</script>
